<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Checkout - Kitab Hub</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="../style.css">
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css"
    crossorigin="anonymous"
    referrerpolicy="no-referrer"
  />
  <style>
    ul li a {
      text-decoration: none;
      color: #38bdf8;
    }
    .checkout-item img {
      width: 80px;
      height: 80px;
      object-fit: cover;
      border-radius: 5px;
    }
    .checkout-item {
      border:1px solid #ccc;
      padding:10px;
      margin-bottom:10px;
      display:flex;
      gap:10px;
      align-items:center;
    }
    .checkout-item div {
      flex: 1;
    }
  </style>
</head>
<body>

  <header>
    <div class="logo">
      <a href="../index.html">
        <img src="../images/kitab2-removebg-preview.png" alt="Bookstore Logo" height="60">
      </a>
    </div>

    <div class="menu-toggle" id="menuToggle">
      <i class="fa-solid fa-bars"></i>
    </div>
    <nav>
      <ul>
        <li><a href="../index.html">Home</a></li>
        <li><a href="cart.html">Cart</a></li>
        <li><a href="checkout.html" class="active">Checkout</a></li>
        <li><a href="./orders.html">My orders</a></li>
      </ul>
    </nav>
  </header>

  
  <h2 style="padding:20px;">Order Summary</h2>
  <div id="checkout-items" style="padding:20px;"></div>
  <h3 style="padding:20px;">Total: ₦<span id="total">0</span></h3>
  <button id="placeOrderBtn" style="margin:20px; padding:10px 20px;">Place Order</button>

  <script>
    const checkoutDiv = document.getElementById('checkout-items');
    const totalEl = document.getElementById('total');
    const placeOrderBtn = document.getElementById('placeOrderBtn');


    let cart = JSON.parse(localStorage.getItem('cart')) || [];

    function renderCheckout() {
      checkoutDiv.innerHTML = '';
      let total = 0;

      if(cart.length === 0) {
        checkoutDiv.innerHTML = '<p>Your cart is empty!</p>';
        totalEl.textContent = 0;
        return;
      }

      cart.forEach(item => {
        total += item.price * item.qty;
        checkoutDiv.innerHTML += `
          <div class="checkout-item">
            <img src="../${item.image}" 
                 onerror="this.onerror=null;this.src='../images/placeholder.png';">
            <div>
              <strong>${item.name}</strong><br>
              ₦${item.price} x ${item.qty} = ₦${item.price * item.qty}
            </div>
          </div>
        `;
      });

      totalEl.textContent = total;
    }

    placeOrderBtn.addEventListener('click', () => {
      if(cart.length === 0){
        alert("Cart is empty!");
        return;
      }
      // Clear cart locally
      localStorage.removeItem('cart');
      cart = [];
      renderCheckout();
      alert("Order placed successfully!");
    
      window.location.href = "../index.html";
    });

    renderCheckout();

    
    const menuToggle = document.getElementById("menuToggle");
    const nav = document.querySelector("header nav");
    menuToggle.addEventListener("click", () => {
      nav.classList.toggle("show");
    });
  </script>
</body>
</html>
